{% extends 'views/layouts/pages/admin_main.html' %}
{% block title %} 
<title>CMS | Add Student</title>
{% endblock %}
{% load static %}
{% block page-css %}
<!-- dito yung page css -->
<link href="{%static 'assets/plugins/DataTables/media/css/dataTables.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/Buttons/css/buttons.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/Responsive/css/responsive.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/AutoFill/css/autoFill.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/ColReorder/css/colReorder.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/KeyTable/css/keyTable.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/RowReorder/css/rowReorder.bootstrap.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/DataTables/extensions/Select/css/select.bootstrap.min.css' %}" rel="stylesheet" />
<!--  -->
<link href="{%static 'assets/plugins/bootstrap-combobox/css/bootstrap-combobox.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/bootstrap-select/bootstrap-select.min.css' %}" rel="stylesheet" />
<link href="{%static 'assets/plugins/select2/dist/css/select2.min.css' %}" rel="stylesheet" />
{% endblock %}
{% block content %}
<!-- dito yung content -->
<div class="content" id="content">
    <!-- begin breadcrumb -->
    <ol class="breadcrumb pull-right">
        <li class="breadcrumb-item"><a href="javascript:;">Student Management</a></li>
        <li class="breadcrumb-item active">Add Student</li>
    </ol>
    <!-- end breadcrumb -->
    <!-- begin page-header -->
    <h1 class="page-header">Add Student <small>Add New Student to the System</small></h1>
    <!-- end page-header -->
    <div class="row">
        <!-- begin col-4 -->
        <div class="col-lg-4">
            <!-- begin panel -->
            <div class="panel panel-inverse">
                <!-- begin panel-heading -->
                <div class="panel-heading">
                    <h4 class="panel-title"><i class="fas fa-user-plus m-r-5"></i>Add Student</h4>
                </div>
                <!-- end panel-heading -->
                <!-- begin panel-body -->
                <div class="panel-body">
                    <form class="form-horizontal" id="add-stud-form" data-parsley-validate="true">
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="studno">Student No. <span class="pull-right">:</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="studno" name="studno" placeholder="Student Number" style="text-transform: capitalize;" />
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="fname">First Name <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="fname" name="fname" placeholder="First Name" data-parsley-required="true" data-parsley-required-message="First Name is required" style="text-transform: capitalize;" />
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="mname">Middle Name <span class="pull-right">:</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="mname" name="mname" placeholder="Middle Name" style="text-transform: capitalize;" />
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="lname">Last Name <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="lname" name="lname" placeholder="Last Name" data-parsley-required="true" data-parsley-required-message="Last Name is required" style="text-transform: capitalize;" />
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="educ-level">Educ Level <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <select id="educ-level" class="form-control selectpicker" data-size="10" data-style="btn-white">
                                    <option selected disabled>Select Level of Education</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="course">Course <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <select id="course" class="form-control selectpicker" data-size="10" data-style="btn-white">
                                    <option selected disabled>Select Course</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="yr">Year Level <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="yr" name="yr" placeholder="Year Level" data-parsley-type="number" data-parsley-required="true" data-parsley-required-message="Year level is required" style="text-transform: capitalize;" maxlength="1" />
                            </div>
                        </div>
                        <!-- <div class="form-group row m-b-15">
                            <label class="col-md-4 col-sm-4 col-form-label" for="sec">Section <span class="pull-right"><span class="text-red">*</span> :</span></label>
                            <div class="col-md-8 col-sm-8">
                                <input class="form-control addstud" type="text" id="sec" name="sec" placeholder="Section" data-parsley-type="number" data-parsley-required="true" data-parsley-required-message="Section is required" maxlength="2" style="text-transform: capitalize;" />
                            </div>
                        </div> -->
                        <div class="modal-footer form-group m-b-0">
                            <a href="javascript:;" class="btn btn-white btn-md" data-dismiss="modal" id="close-stud-but"><i class="fas fa-times-circle m-r-5"></i>Close</a>
                            <a href="javascript:;" class="btn btn-success btn-md" id="add-stud-but"><i class="fas fa-plus-circle m-r-5" id="add-stud-but-icon"></i>Add</a>
                        </div>
                    </form>
                </div>
                <!-- end panel-body -->
            </div>
            <!-- end panel -->
        </div>
        <!-- end col-4 -->
        <!-- begin col-8 -->
        <div class="col-lg-8">
            <!-- begin panel -->
            <div class="panel panel-inverse">
                <!-- begin panel-heading -->
                <div class="panel-heading">
                    <h4 class="panel-title"><i class="fas fa-list m-r-5"></i>Student List</h4>
                </div>
                <!-- end panel-heading -->
                <!-- begin panel-body -->
                <div class="panel-body">
                    <table class="table table-hover table-striped" id="stud-tbl">
                        <thead>
                            <th class="text-center" width="5%">No.</th>
                            <th class="text-center" width="30%">Student No.</th>
                            <th class="text-center" width="35%">Full Name</th>
                            <th class="text-center" width="30%">Course</th>
                        </thead>
                    </table>
                </div>
                <!-- end panel-body -->
            </div>
            <!-- end panel -->
        </div>
        <!-- end col-8 -->
    </div>
</div>
{% endblock %}
{% block page-js %}
<!-- dito yung page-js -->
<script src="{%static 'assets/plugins/chart-js/Chart.min.js' %}"></script>
<script src="{%static 'assets/js/demo/chart-js.demo.min.js' %}"></script>
<!--  -->
<script src="{%static 'assets/plugins/DataTables/media/js/jquery.dataTables.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/media/js/dataTables.bootstrap.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/buttons.bootstrap.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/buttons.flash.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/jszip.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/pdfmake.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/vfs_fonts.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/buttons.html5.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Buttons/js/buttons.print.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Responsive/js/dataTables.responsive.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/AutoFill/js/dataTables.autoFill.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/ColReorder/js/dataTables.colReorder.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/KeyTable/js/dataTables.keyTable.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/RowReorder/js/dataTables.rowReorder.min.js' %}"></script>
<script src="{%static 'assets/plugins/DataTables/extensions/Select/js/dataTables.select.min.js' %}"></script>
<script src="{%static 'assets/js/demo/table-manage-combine.demo.min.js' %}"></script>
<!--  -->
<script src="{%static 'assets/plugins/bootstrap-combobox/js/bootstrap-combobox.js' %}"></script>
<script src="{%static 'assets/plugins/bootstrap-select/bootstrap-select.min.js' %}"></script>
<script src="{%static 'assets/plugins/select2/dist/js/select2.min.js' %}"></script>
{% endblock %}
{% block init %}
<script>
    $(document).ready(function() {
        App.init();
        highlightSideNav();
        $('#course').selectpicker('render');
        $('#educ-level').selectpicker('render');
        loadEducLevel();
    });

    loadStudTbl();

    function loadEducLevel() {
        $.ajax({
            url: "load_educ_level",
            type: "POST",
            cache: false,
            dataType: 'json',
            data: {
                csrfmiddlewaretoken: "{{csrf_token}}"
            },
            success: function(obj) {
                $.each(obj, function(index, option){
                    if (option[1] == 1) {
                        $('#educ-level').append( new Option(option[0],option[0])); //value and text
                    }
                });
                $('#educ-level').selectpicker('refresh');
            },
            error: function(xhr, status, error) {
                swal({
                    title: "Error!", 
                    text: error,
                    type: "error",
                    confirmButtonColor: "#428bca",
                    showLoaderOnConfirm: true
                });
            }
        });
    };

    var dt_stud = $('#stud-tbl').DataTable({
        'paging'      : true,
        'lengthChange': true,
        'searching'   : true,
        'ordering'    : true,
        'info'        : true,
        'autoWidth'   : true,
        'order'       : [0,'asc'],
        dom: 'lBfrtip',
    buttons: [
        {
            extend:    'print',
            text:      '<i class="fas fa-print text-orange-lighter f-s-16"></i>',
            titleAttr: 'Print',
            title: 'Student List',
            exportOptions: {
                columns: [0,1,2,3]
            }
        },
        {
            extend:    'excel',
            text:      '<i class="fas fa-file-excel text-green-lighter f-s-16"></i>',
            titleAttr: 'Excel',
            title: 'Student List',
            exportOptions: {
                columns: [0,1,2,3]
            }
        },
        {
            extend:    'pdf',
            text:      '<i class="fas fa-file-pdf text-red-lighter f-s-16"></i>',
            titleAttr: 'PDF',
            title: 'Student List',
            customize: function (doc) {
                doc.content[1].table.widths = 
                    Array(doc.content[1].table.body[0].length + 1).join('*').split('');
            },
            exportOptions: {
                columns: [0,1,2,3]
            }
        }
    ],
    "lengthMenu": [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
    columnDefs:[
        {
            targets:2, render:function(data){
                return $.trim(data).toUpperCase();
            },
        },
        {
            targets:[0,1,2,3],
                className: 'text-center',  
        },
    ]

    });

    function loadStudTbl() {
        $.ajax({
            url: "load_stud_tbl",
            type: "POST",
            cache: false,
            dataType: 'json',
            data: {
                csrfmiddlewaretoken: "{{csrf_token}}"
            },
            success: function(obj) {
                dt_stud.clear().draw();
                $.each(obj, function(index, data){
                    dt_stud.row.add( [
                        index+1
                        ,data[0]
                        ,data[1]
                        ,data[2]
                    ] ).draw();
                });
            },
            error: function(xhr, status, error) {
                var errMsg = xhr.status + ': ' + xhr.statusText;
                swal({
                    title: "Error!", 
                    text: errMsg,
                    type: "error",
                    confirmButtonColor: "#428bca",
                    showLoaderOnConfirm: true
                })
            }
        });
    };

    function highlightSideNav() {
        $('#li-dash').removeClass('text-white');
        $('#li-user-mngt').removeClass('text-white');
        $('#li-add').removeClass('text-white');
        $('#li-edit').removeClass('text-white');
        $('#li-conf').removeClass('text-white');
        $('#li-orsetup').removeClass('text-white');
        $('#setup').removeClass('text-white');
        $('#li-email').removeClass('text-white');
        $('#li-stud-mngt').addClass('text-white');
        $('#li-stud-mngt').click();
        $('#li-add-stud').addClass('text-white');
        $('#li-educ-level').removeClass('text-white');
        $('#li-add-course').removeClass('text-white');
    };
</script>
{% endblock %}